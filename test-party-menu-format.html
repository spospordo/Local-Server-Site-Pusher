<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Party Widget Menu Format Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: white;
            margin: 0;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #4CAF50;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }
        
        .phase-section {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #333;
        }
        
        .phase-section h2 {
            margin-top: 0;
            color: #4CAF50;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #333;
        }
        
        .phase-section.before {
            border-color: #2196F3;
        }
        
        .phase-section.during {
            border-color: #4CAF50;
        }
        
        .widget-container {
            margin-top: 20px;
        }
        
        .info-box {
            background: rgba(33, 150, 243, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #2196F3;
        }
        
        .info-box.during-info {
            background: rgba(76, 175, 80, 0.1);
            border-left-color: #4CAF50;
        }
        
        .info-box h3 {
            margin-top: 0;
            font-size: 0.9rem;
        }
        
        .info-box ul {
            margin: 10px 0 0 0;
            padding-left: 20px;
        }
        
        .info-box li {
            margin: 5px 0;
            font-size: 0.85rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéâ Party Widget Menu Format Test</h1>
        <p style="text-align: center; opacity: 0.8;">
            Testing menu assignments (before party) and descriptions (during party) with two-column layout
        </p>
        
        <div class="test-grid">
            <!-- Before Party Phase -->
            <div class="phase-section before">
                <h2>üìã Before Party Phase</h2>
                <div class="info-box">
                    <h3>Expected Display:</h3>
                    <ul>
                        <li>‚úÖ Menu header: "üçΩÔ∏è Menu & Assignments"</li>
                        <li>‚úÖ Show menu item names</li>
                        <li>‚úÖ Show assignee (who's responsible)</li>
                        <li>‚ùå Hide descriptions</li>
                        <li>‚úÖ Two-column layout</li>
                    </ul>
                </div>
                <div id="beforeParty" class="widget-container"></div>
            </div>
            
            <!-- During Party Phase -->
            <div class="phase-section during">
                <h2>üéä During Party Phase</h2>
                <div class="info-box during-info">
                    <h3>Expected Display:</h3>
                    <ul>
                        <li>‚úÖ Menu header: "üçΩÔ∏è Menu"</li>
                        <li>‚úÖ Show menu item names</li>
                        <li>‚úÖ Show descriptions</li>
                        <li>‚ùå Hide assignees</li>
                        <li>‚úÖ Two-column layout</li>
                    </ul>
                </div>
                <div id="duringParty" class="widget-container"></div>
            </div>
        </div>
    </div>
    
    <script>
        // Sample party data
        const partyData = {
            dateTime: {
                date: "2026-02-08",
                startTime: "18:00"
            },
            daysUntil: 2,
            name: "Test Party",
            menu: [
                {
                    id: 1,
                    item: "Caesar Salad",
                    description: "Fresh romaine with homemade dressing and croutons",
                    assignee: "Alice"
                },
                {
                    id: 2,
                    item: "Grilled Salmon",
                    description: "Wild-caught salmon with lemon butter sauce",
                    assignee: "Bob"
                },
                {
                    id: 3,
                    item: "Chocolate Cake",
                    description: "Three-layer chocolate fudge cake with ganache",
                    assignee: "Charlie"
                },
                {
                    id: 4,
                    item: "Veggie Platter",
                    description: "Assorted fresh vegetables with hummus dip",
                    assignee: "Dana"
                }
            ],
            tasks: {
                total: 2,
                completed: 1,
                list: [
                    { id: 1, name: "Clean living room", assignee: "Alice", completed: true },
                    { id: 2, name: "Buy groceries", assignee: "Bob", completed: false }
                ]
            },
            invitees: {
                coming: 5,
                notComing: 1,
                pending: 2,
                list: [
                    { id: 1, name: "John", rsvp: "coming" },
                    { id: 2, name: "Jane", rsvp: "coming" }
                ]
            },
            events: [
                { id: 1, time: "18:00", title: "Arrival", description: "Guests arrive" },
                { id: 2, time: "19:00", title: "Dinner", description: "Main course" }
            ]
        };
        
        // Copy the renderParty function from smart-mirror.html
        // This is extracted from the actual implementation
        function renderParty(data) {
            if (!data || !data.dateTime || !data.dateTime.date || data.daysUntil === undefined) {
                console.error('Party widget: Missing required data', data);
                return null;
            }
            
            const PARTY_WIDGET_MAX_HEIGHT = '80vh';
            const container = document.createElement('div');
            container.className = 'party-widget';
            container.style.padding = '10px';
            container.style.maxHeight = PARTY_WIDGET_MAX_HEIGHT;
            container.style.overflowY = 'auto';
            
            const isDuringParty = data.phase === 'during';
            
            // Header with icon
            const headerDiv = document.createElement('div');
            headerDiv.style.textAlign = 'center';
            headerDiv.style.marginBottom = '12px';
            
            const iconDiv = document.createElement('div');
            iconDiv.style.fontSize = '2rem';
            iconDiv.style.marginBottom = '5px';
            iconDiv.textContent = 'üéâ';
            headerDiv.appendChild(iconDiv);
            
            const titleDiv = document.createElement('div');
            titleDiv.style.fontSize = '1.1rem';
            titleDiv.style.fontWeight = '600';
            
            if (data.daysUntil === 0) {
                titleDiv.textContent = isDuringParty ? 'Party in Progress!' : 'Party Today!';
                titleDiv.style.color = '#4CAF50';
            } else if (data.daysUntil === 1) {
                titleDiv.textContent = 'Party Tomorrow';
            } else {
                titleDiv.textContent = `Party in ${data.daysUntil} days`;
            }
            headerDiv.appendChild(titleDiv);
            
            const phaseDiv = document.createElement('div');
            phaseDiv.style.fontSize = '0.75rem';
            phaseDiv.style.opacity = '0.7';
            phaseDiv.style.marginTop = '3px';
            phaseDiv.textContent = isDuringParty ? 'üéä Enjoy the party!' : 'üìã Party Planning';
            headerDiv.appendChild(phaseDiv);
            
            container.appendChild(headerDiv);
            
            // Content section - Two-column layout
            const contentDiv = document.createElement('div');
            contentDiv.style.fontSize = '0.8rem';
            contentDiv.style.marginTop = '10px';
            contentDiv.style.display = 'grid';
            contentDiv.style.gridTemplateColumns = 'repeat(auto-fit, minmax(250px, 1fr))';
            contentDiv.style.gap = '15px';
            
            // Tasks - only show in pre-party phase
            if (!isDuringParty && data.tasks && data.tasks.list && data.tasks.list.length > 0) {
                const tasksSection = document.createElement('div');
                tasksSection.style.marginBottom = '15px';
                
                const tasksHeader = document.createElement('div');
                tasksHeader.style.fontWeight = '600';
                tasksHeader.style.marginBottom = '8px';
                tasksHeader.style.fontSize = '0.9rem';
                tasksHeader.innerHTML = '‚úì To-Do Items';
                tasksSection.appendChild(tasksHeader);
                
                data.tasks.list.forEach(task => {
                    const taskItem = document.createElement('div');
                    taskItem.style.marginBottom = '5px';
                    taskItem.style.paddingLeft = '10px';
                    taskItem.style.opacity = task.completed ? '0.6' : '1';
                    
                    const checkbox = document.createElement('span');
                    checkbox.textContent = task.completed ? '‚òë' : '‚òê';
                    checkbox.style.marginRight = '5px';
                    
                    const taskText = document.createElement('span');
                    taskText.textContent = task.name;
                    if (task.completed) {
                        taskText.style.textDecoration = 'line-through';
                    }
                    
                    taskItem.appendChild(checkbox);
                    taskItem.appendChild(taskText);
                    
                    if (task.assignee) {
                        const assigneeText = document.createElement('span');
                        assigneeText.textContent = ` (${task.assignee})`;
                        assigneeText.style.opacity = '0.7';
                        assigneeText.style.fontSize = '0.75rem';
                        taskItem.appendChild(assigneeText);
                    }
                    
                    tasksSection.appendChild(taskItem);
                });
                
                contentDiv.appendChild(tasksSection);
            }
            
            // Events
            if (data.events && data.events.length > 0) {
                const eventsSection = document.createElement('div');
                eventsSection.style.marginBottom = '15px';
                
                const eventsHeader = document.createElement('div');
                eventsHeader.style.fontWeight = '600';
                eventsHeader.style.marginBottom = '8px';
                eventsHeader.style.fontSize = '0.9rem';
                eventsHeader.innerHTML = 'üìã Events Schedule';
                eventsSection.appendChild(eventsHeader);
                
                data.events.forEach(event => {
                    const eventItem = document.createElement('div');
                    eventItem.style.marginBottom = '8px';
                    eventItem.style.paddingLeft = '10px';
                    
                    const eventTitle = document.createElement('div');
                    eventTitle.style.fontWeight = '500';
                    
                    if (event.time) {
                        const timeSpan = document.createElement('span');
                        timeSpan.textContent = event.time + ' - ';
                        timeSpan.style.color = '#4CAF50';
                        eventTitle.appendChild(timeSpan);
                    }
                    
                    const titleSpan = document.createElement('span');
                    titleSpan.textContent = event.title;
                    eventTitle.appendChild(titleSpan);
                    
                    eventItem.appendChild(eventTitle);
                    
                    if (event.description) {
                        const eventDesc = document.createElement('div');
                        eventDesc.textContent = event.description;
                        eventDesc.style.fontSize = '0.75rem';
                        eventDesc.style.opacity = '0.7';
                        eventDesc.style.marginTop = '2px';
                        eventItem.appendChild(eventDesc);
                    }
                    
                    eventsSection.appendChild(eventItem);
                });
                
                contentDiv.appendChild(eventsSection);
            }
            
            // Menu - show in both phases with different info
            if (data.menu && data.menu.length > 0) {
                const menuSection = document.createElement('div');
                menuSection.style.marginBottom = '15px';
                
                const menuHeader = document.createElement('div');
                menuHeader.style.fontWeight = '600';
                menuHeader.style.marginBottom = '8px';
                menuHeader.style.fontSize = '0.9rem';
                menuHeader.innerHTML = isDuringParty ? 'üçΩÔ∏è Menu' : 'üçΩÔ∏è Menu & Assignments';
                menuSection.appendChild(menuHeader);
                
                data.menu.forEach(item => {
                    const menuItem = document.createElement('div');
                    menuItem.style.marginBottom = '8px';
                    menuItem.style.paddingLeft = '10px';
                    
                    const itemName = document.createElement('div');
                    itemName.style.fontWeight = '500';
                    itemName.textContent = item.item || item.name;
                    menuItem.appendChild(itemName);
                    
                    // Before party: Show assignee
                    if (!isDuringParty && item.assignee) {
                        const assigneeDiv = document.createElement('div');
                        assigneeDiv.textContent = `üë§ ${item.assignee}`;
                        assigneeDiv.style.fontSize = '0.75rem';
                        assigneeDiv.style.opacity = '0.7';
                        assigneeDiv.style.marginTop = '2px';
                        assigneeDiv.style.fontStyle = 'italic';
                        menuItem.appendChild(assigneeDiv);
                    }
                    
                    // During party: Show description
                    if (isDuringParty && item.description) {
                        const itemDesc = document.createElement('div');
                        itemDesc.textContent = item.description;
                        itemDesc.style.fontSize = '0.75rem';
                        itemDesc.style.opacity = '0.7';
                        itemDesc.style.marginTop = '2px';
                        menuItem.appendChild(itemDesc);
                    }
                    
                    menuSection.appendChild(menuItem);
                });
                
                contentDiv.appendChild(menuSection);
            }
            
            // Invitees
            if (data.invitees && data.invitees.list && data.invitees.list.length > 0) {
                const inviteesSection = document.createElement('div');
                inviteesSection.style.marginBottom = '15px';
                
                const inviteesHeader = document.createElement('div');
                inviteesHeader.style.fontWeight = '600';
                inviteesHeader.style.marginBottom = '8px';
                inviteesHeader.style.fontSize = '0.9rem';
                inviteesHeader.innerHTML = 'üë• Guest List';
                inviteesSection.appendChild(inviteesHeader);
                
                const coming = data.invitees.list.filter(i => i.rsvp === 'coming');
                
                if (coming.length > 0) {
                    const comingLabel = document.createElement('div');
                    comingLabel.style.fontSize = '0.75rem';
                    comingLabel.style.opacity = '0.7';
                    comingLabel.style.marginTop = '5px';
                    comingLabel.textContent = 'Coming:';
                    inviteesSection.appendChild(comingLabel);
                    
                    coming.forEach(invitee => {
                        const inviteeItem = document.createElement('div');
                        inviteeItem.style.paddingLeft = '10px';
                        inviteeItem.textContent = `‚úì ${invitee.name}`;
                        inviteeItem.style.color = '#4CAF50';
                        inviteesSection.appendChild(inviteeItem);
                    });
                }
                
                contentDiv.appendChild(inviteesSection);
            }
            
            container.appendChild(contentDiv);
            return container;
        }
        
        // Render both phases
        const beforeData = { ...partyData, phase: 'pre-party' };
        const duringData = { ...partyData, phase: 'during', daysUntil: 0 };
        
        document.getElementById('beforeParty').appendChild(renderParty(beforeData));
        document.getElementById('duringParty').appendChild(renderParty(duringData));
    </script>
</body>
</html>
